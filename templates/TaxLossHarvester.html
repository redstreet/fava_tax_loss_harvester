{% import "_query_table.html" as querytable with context %}

<h2>Tax Loss Harvester</h2>
<br />

{% set harvests = extension.harvestable(None, None) %}

<h3>Summary</h3>
<table class="sortable">
  <thead>
    <tr>
      <th data-sort="string">{{ _('Summary') }}</th>
      <th data-sort="string">{{ _('Val') }}</th>
    </tr>
  </thead>
  <tbody>

    {% for key, value in harvests[1].items() %}
    <tr>
      <td>{{ key }}</td>
      <td align="right">{{ value }}</td>
    </tr>
    {% endfor %}

  </tbody>
</table>
<br />



<h3>Harvestable Losses by Commodity</h3>
{{ querytable.querytable(None, *harvests[3]) }}
<br />


<h3>Candidates for tax loss harvesting</h3>
{{ querytable.querytable(None, *harvests[0]) }}
<br />



<h3>Purchases within the past 30 days creating wash sales</h3>
{% if harvests[2][0]|length == 0 %}
   <p>None found!</p>
{% else %}
  {{ querytable.querytable(None, *harvests[2]) }}
{% endif %}


